<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>jså¸¸ç”¨çš„å„ç§æ’ä»¶ ğŸ | gp&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="å­¦è€Œæ—¶ä¹ ä¹‹ä¸äº¦è¯´ä¹ï¼Œæœ‰æœ‹è‡³è¿œæ–¹æ¥ä¸äº¦ä¹ä¹ã€‚">
    
    <link rel="preload" href="/blog/assets/css/0.styles.e32d6808.css" as="style"><link rel="preload" href="/blog/assets/js/app.95d1cef2.js" as="script"><link rel="preload" href="/blog/assets/js/2.dd56d6fa.js" as="script"><link rel="preload" href="/blog/assets/js/1.05d0606b.js" as="script"><link rel="preload" href="/blog/assets/js/18.6933475c.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.d6c6ae10.js"><link rel="prefetch" href="/blog/assets/js/11.76751111.js"><link rel="prefetch" href="/blog/assets/js/12.3f432822.js"><link rel="prefetch" href="/blog/assets/js/13.659f6263.js"><link rel="prefetch" href="/blog/assets/js/14.b7d50a96.js"><link rel="prefetch" href="/blog/assets/js/15.f2ea1e73.js"><link rel="prefetch" href="/blog/assets/js/16.e1b887ae.js"><link rel="prefetch" href="/blog/assets/js/17.3c6d46a7.js"><link rel="prefetch" href="/blog/assets/js/19.e4b19d88.js"><link rel="prefetch" href="/blog/assets/js/20.ff3cf5e0.js"><link rel="prefetch" href="/blog/assets/js/21.da843f56.js"><link rel="prefetch" href="/blog/assets/js/22.88ae7534.js"><link rel="prefetch" href="/blog/assets/js/23.ef58a1cf.js"><link rel="prefetch" href="/blog/assets/js/24.015b2e47.js"><link rel="prefetch" href="/blog/assets/js/25.b9ea98ae.js"><link rel="prefetch" href="/blog/assets/js/26.afff07f5.js"><link rel="prefetch" href="/blog/assets/js/27.4f749e22.js"><link rel="prefetch" href="/blog/assets/js/28.db5dceeb.js"><link rel="prefetch" href="/blog/assets/js/29.424d615d.js"><link rel="prefetch" href="/blog/assets/js/3.1fe88f52.js"><link rel="prefetch" href="/blog/assets/js/30.55370f33.js"><link rel="prefetch" href="/blog/assets/js/31.a2ef508f.js"><link rel="prefetch" href="/blog/assets/js/32.e41c0b91.js"><link rel="prefetch" href="/blog/assets/js/33.006146e5.js"><link rel="prefetch" href="/blog/assets/js/34.d5412c8a.js"><link rel="prefetch" href="/blog/assets/js/35.4d4bdb76.js"><link rel="prefetch" href="/blog/assets/js/36.da619ea8.js"><link rel="prefetch" href="/blog/assets/js/37.011124d2.js"><link rel="prefetch" href="/blog/assets/js/38.6e156ef0.js"><link rel="prefetch" href="/blog/assets/js/39.00ba53dc.js"><link rel="prefetch" href="/blog/assets/js/4.f354b7a5.js"><link rel="prefetch" href="/blog/assets/js/40.0699260a.js"><link rel="prefetch" href="/blog/assets/js/41.5834c084.js"><link rel="prefetch" href="/blog/assets/js/42.711c5521.js"><link rel="prefetch" href="/blog/assets/js/43.44528f35.js"><link rel="prefetch" href="/blog/assets/js/44.da96ff0e.js"><link rel="prefetch" href="/blog/assets/js/45.8dd701e9.js"><link rel="prefetch" href="/blog/assets/js/46.585555a0.js"><link rel="prefetch" href="/blog/assets/js/47.c0938123.js"><link rel="prefetch" href="/blog/assets/js/48.f3664d9d.js"><link rel="prefetch" href="/blog/assets/js/49.a489ca1f.js"><link rel="prefetch" href="/blog/assets/js/5.cd1a2312.js"><link rel="prefetch" href="/blog/assets/js/50.ea2493a2.js"><link rel="prefetch" href="/blog/assets/js/51.59649d9f.js"><link rel="prefetch" href="/blog/assets/js/52.a8f9c310.js"><link rel="prefetch" href="/blog/assets/js/53.f6e7ba1a.js"><link rel="prefetch" href="/blog/assets/js/54.1b302df0.js"><link rel="prefetch" href="/blog/assets/js/55.31623364.js"><link rel="prefetch" href="/blog/assets/js/56.a727b56c.js"><link rel="prefetch" href="/blog/assets/js/57.fc50f9fe.js"><link rel="prefetch" href="/blog/assets/js/58.83bdfda3.js"><link rel="prefetch" href="/blog/assets/js/59.a935ae25.js"><link rel="prefetch" href="/blog/assets/js/6.21902164.js"><link rel="prefetch" href="/blog/assets/js/60.2640c0e6.js"><link rel="prefetch" href="/blog/assets/js/61.1c66210c.js"><link rel="prefetch" href="/blog/assets/js/62.ec487adf.js"><link rel="prefetch" href="/blog/assets/js/63.8029a8bf.js"><link rel="prefetch" href="/blog/assets/js/64.4db62b40.js"><link rel="prefetch" href="/blog/assets/js/65.5f9ee2be.js"><link rel="prefetch" href="/blog/assets/js/66.50270f75.js"><link rel="prefetch" href="/blog/assets/js/67.6658d81f.js"><link rel="prefetch" href="/blog/assets/js/68.629a4ae1.js"><link rel="prefetch" href="/blog/assets/js/69.3a46e860.js"><link rel="prefetch" href="/blog/assets/js/7.2b89de10.js"><link rel="prefetch" href="/blog/assets/js/70.5e912eac.js"><link rel="prefetch" href="/blog/assets/js/71.1640dba1.js"><link rel="prefetch" href="/blog/assets/js/72.32d6a03f.js"><link rel="prefetch" href="/blog/assets/js/73.63ed6547.js"><link rel="prefetch" href="/blog/assets/js/74.30db84d2.js"><link rel="prefetch" href="/blog/assets/js/75.44ed3954.js"><link rel="prefetch" href="/blog/assets/js/vendors~docsearch.e2498148.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.e32d6808.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">gp's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/article/JavaScript/Rule.html" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/blog/AboutMe.html" class="nav-link">
  Resume
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/article/JavaScript/Rule.html" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/blog/AboutMe.html" class="nav-link">
  Resume
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/article/JavaScript/Optimization.html" class="sidebar-link">ä¼˜åŒ–</a></li><li><a href="/blog/article/JavaScript/Rule.html" class="sidebar-link">ä»£ç è§„èŒƒ</a></li><li><a href="/blog/article/JavaScript/QA-daily.html" class="sidebar-link">ç»ƒä¹ é¢˜ç›®</a></li><li><a href="/blog/article/JavaScript/Object.html" class="sidebar-link">å¯¹è±¡</a></li><li><a href="/blog/article/JavaScript/Array.html" class="sidebar-link">æ•°ç»„</a></li><li><a href="/blog/article/JavaScript/Function.html" class="sidebar-link">å‡½æ•°</a></li><li><a href="/blog/article/JavaScript/Ram.html" class="sidebar-link">å†…å­˜</a></li><li><a href="/blog/article/JavaScript/Method.html" class="sidebar-link">å¸¸ç”¨æ–¹æ³•</a></li><li><a href="/blog/article/JavaScript/PublicFunction.html" class="sidebar-link">å…¬å…±æ–¹æ³•</a></li><li><a href="/blog/article/JavaScript/Robustness.html" class="sidebar-link">ä»£ç å¥å£®æ€§</a></li><li><a href="/blog/article/JavaScript/Tree.html" class="sidebar-link">æ ‘</a></li><li><a href="/blog/article/JavaScript/This.html" class="sidebar-link">thisæŒ‡å‘</a></li><li><a href="/blog/article/JavaScript/EventLoop.html" class="sidebar-link">äº‹ä»¶å¾ªç¯æœºåˆ¶</a></li><li><a href="/blog/article/JavaScript/CrossDomain.html" class="sidebar-link">è·¨åŸŸ</a></li><li><a href="/blog/article/JavaScript/Bubble.html" class="sidebar-link">å†’æ³¡</a></li><li><a href="/blog/article/JavaScript/CommonlyMethod.html" class="sidebar-link">æ•°æ®ç‰¹æ®Šå¤„ç†</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>css</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/article/Css/Css.html" class="sidebar-link">css</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/article/Vue/Components.html" class="sidebar-link">ç»„ä»¶</a></li><li><a href="/blog/article/Vue/CrossDomain.html" class="sidebar-link">è·¨åŸŸ</a></li><li><a href="/blog/article/Vue/Reconstruction.html" class="sidebar-link">é¡¹ç›®é‡æ„ä¼˜åŒ–</a></li><li><a href="/blog/article/Vue/Question.html" class="sidebar-link">vueé—®é¢˜</a></li><li><a href="/blog/article/Vue/FileHandle.html" class="sidebar-link">æ–‡ä»¶å¤„ç†</a></li><li><a href="/blog/article/Vue/Router.html" class="sidebar-link">è·¯ç”±</a></li><li><a href="/blog/article/Vue/Table.html" class="sidebar-link">è¡¨æ ¼</a></li><li><a href="/blog/article/Vue/SpecialPage.html" class="sidebar-link">é¡µé¢</a></li><li><a href="/blog/article/Vue/Seo.html" class="sidebar-link">SEOä¼˜åŒ–</a></li><li><a href="/blog/article/Vue/Package.html" class="sidebar-link">packageé…ç½®</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>App</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/article/APP/UniApp.html" class="sidebar-link">uni-app</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Other</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/article/Other/Git.html" class="sidebar-link">gitæ“ä½œ</a></li><li><a href="/blog/article/Other/Canvas.html" class="sidebar-link">canvas</a></li><li><a href="/blog/article/Other/Qiankun.html" class="sidebar-link">qiankun</a></li><li><a href="/blog/article/Other/LODOP.html" class="sidebar-link">lodopæ’ä»¶</a></li><li><a href="/blog/article/Other/Npm.html" class="sidebar-link">npmç§æœ‰åº“</a></li><li><a href="/blog/article/Other/Interview.html" class="sidebar-link">é—®é¢˜æ€»ç»“</a></li><li><a href="/blog/article/Other/ProjectLssues.html" class="sidebar-link">è¿è¡Œé¡¹ç›®é—®é¢˜</a></li><li><a href="/blog/article/Other/OnlinePayment.html" class="sidebar-link">åœ¨çº¿æ”¯ä»˜</a></li><li><a href="/blog/article/Other/PluginUnit.html" aria-current="page" class="active sidebar-link">jså¸¸ç”¨çš„å„ç§æ’ä»¶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/article/Other/PluginUnit.html#html2canvas-htmlè½¬canvas-å›¾ç‰‡å·¥å…·" class="sidebar-link">html2canvas HTMLè½¬Canvas/å›¾ç‰‡å·¥å…·</a></li><li class="sidebar-sub-header"><a href="/blog/article/Other/PluginUnit.html#domtoimage-å›¾ç‰‡ç”Ÿæˆå·¥å…·" class="sidebar-link">domtoimage å›¾ç‰‡ç”Ÿæˆå·¥å…·</a></li><li class="sidebar-sub-header"><a href="/blog/article/Other/PluginUnit.html#puppeteer-æ— å¤´æµè§ˆå™¨" class="sidebar-link">puppeteer æ— å¤´æµè§ˆå™¨</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/article/Other/PluginUnit.html#ä»€ä¹ˆæ˜¯æ— å¤´æµè§ˆå™¨" class="sidebar-link">ä»€ä¹ˆæ˜¯æ— å¤´æµè§ˆå™¨</a></li><li class="sidebar-sub-header"><a href="/blog/article/Other/PluginUnit.html#puppeteerçš„ä½¿ç”¨" class="sidebar-link">puppeteerçš„ä½¿ç”¨</a></li><li class="sidebar-sub-header"><a href="/blog/article/Other/PluginUnit.html#puppeteer-coreçš„ä½¿ç”¨åœºæ™¯" class="sidebar-link">puppeteer-coreçš„ä½¿ç”¨åœºæ™¯</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/article/Other/PluginUnit.html#jspdfè½¬pdfå·¥å…·" class="sidebar-link">jspdfè½¬pdfå·¥å…·</a></li><li class="sidebar-sub-header"><a href="/blog/article/Other/PluginUnit.html#html2pdf-å®ç°é¢„è§ˆã€ä¸‹è½½ã€æ‰“å°" class="sidebar-link">html2pdf å®ç°é¢„è§ˆã€ä¸‹è½½ã€æ‰“å°</a></li><li class="sidebar-sub-header"><a href="/blog/article/Other/PluginUnit.html#pdfjs-dist-å®ç°pdfé¢„è§ˆ" class="sidebar-link">pdfjs-dist å®ç°pdfé¢„è§ˆ</a></li><li class="sidebar-sub-header"><a href="/blog/article/Other/PluginUnit.html#xlsx-å®ç°çº¿ä¸Šxlsxé¢„è§ˆ" class="sidebar-link">xlsx å®ç°çº¿ä¸Šxlsxé¢„è§ˆ</a></li><li class="sidebar-sub-header"><a href="/blog/article/Other/PluginUnit.html#ssh2-archiver-å®ç°ä»£ç è‡ªåŠ¨æ‰“åŒ…ä¸Šä¼ " class="sidebar-link">ssh2 + archiver å®ç°ä»£ç è‡ªåŠ¨æ‰“åŒ…ä¸Šä¼ </a></li><li class="sidebar-sub-header"><a href="/blog/article/Other/PluginUnit.html#cbl-deploy-tools-å®ç°ä»£ç è‡ªåŠ¨æ‰“åŒ…ä¸Šä¼ " class="sidebar-link">cbl-deploy-tools å®ç°ä»£ç è‡ªåŠ¨æ‰“åŒ…ä¸Šä¼ </a></li></ul></li><li><a href="/blog/article/Other/Vscode.html" class="sidebar-link">vscodeå¸¸ç”¨æ’ä»¶</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Three</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/article/Three/Overview.html" class="sidebar-link">Threeæ¦‚è§ˆ</a></li><li><a href="/blog/article/Three/Optimize.html" class="sidebar-link">Threeæ€§èƒ½ä¼˜åŒ–</a></li><li><a href="/blog/article/Three/IntelligentPackingFunction.html" class="sidebar-link">Threeå¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</a></li><li><a href="/blog/article/Three/Cannon.html" class="sidebar-link">Cannonç‰©ç†å¼•æ“</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Python</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/article/Python/Grammar.html" class="sidebar-link">Grammar</a></li><li><a href="/blog/article/Python/PySide6.html" class="sidebar-link">PySide6</a></li><li><a href="/blog/article/Python/Use.html" class="sidebar-link">Use</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="jså¸¸ç”¨çš„å„ç§æ’ä»¶"><a href="#jså¸¸ç”¨çš„å„ç§æ’ä»¶" class="header-anchor">#</a> jså¸¸ç”¨çš„å„ç§æ’ä»¶ ğŸ</h1> <h2 id="html2canvas-htmlè½¬canvas-å›¾ç‰‡å·¥å…·"><a href="#html2canvas-htmlè½¬canvas-å›¾ç‰‡å·¥å…·" class="header-anchor">#</a> html2canvas HTMLè½¬Canvas/å›¾ç‰‡å·¥å…·</h2> <p><code>html2canvas.js</code>æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æ’ä»¶ï¼Œå®ƒå¯ä»¥è½»æ¾åœ°å¸®ä½ å°†<code>HTML</code>ä»£ç è½¬æ¢æˆ<code>Canvas</code>ï¼Œè¿›è€Œç”Ÿæˆå¯ä¿å­˜åˆ†äº«çš„å›¾ç‰‡ã€‚</p> <p><strong>æ³¨æ„ï¼šè¯¥æ’ä»¶æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ¯æ‰§è¡Œä¸€æ¬¡<code>htmlhtml2canvas</code>æ—¶ï¼Œä¼šé‡æ–°åŠ è½½ä¸€éç³»ç»Ÿçš„é™æ€èµ„æºï¼Œå¯¼è‡´ç”Ÿæˆå›¾ç‰‡å¾ˆæ…¢åŠæµè§ˆå™¨å†…å­˜å ç”¨ä¸¥é‡ï¼Œæ‰€ä»¥åœ¨æˆªå›¾å¾ˆå¤šéçš„æ—¶å€™éœ€è¦æ¢ä¸€ä¸ªæ’ä»¶<code>domtoimage</code></strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>zh-CN<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>qianduanwz<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>æˆªå›¾å†…å®¹<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
            <span class="token comment">// ä½¿ç”¨ç«‹å³æ‰§è¡Œå¼‚æ­¥å‡½æ•°ï¼Œä»¥ä¾¿ä½¿ç”¨ await</span>
            <span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token keyword">const</span> targetElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'qianduanwz'</span><span class="token punctuation">)</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>targetElement<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">return</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">const</span> canvas <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">html2canvas</span><span class="token punctuation">(</span>targetElement<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                        <span class="token comment">// å…è®¸è·¨åŸŸèµ„æº</span>
                        <span class="token literal-property property">useCORS</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> 
                        <span class="token comment">// å…³é—­æ—¥å¿—è®°å½•ï¼Œå‡å°‘æ€§èƒ½å¼€é”€</span>
                        <span class="token literal-property property">logging</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> 
                        <span class="token comment">// é™ä½ dpi å’Œ scaleï¼Œå‡å°‘èµ„æºéœ€æ±‚</span>
                        <span class="token literal-property property">dpi</span><span class="token operator">:</span> window<span class="token punctuation">.</span>devicePixelRatio<span class="token punctuation">,</span> 
                        <span class="token literal-property property">scale</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token keyword">let</span> oImg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    oImg<span class="token punctuation">.</span>src <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">'image/jpeg'</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">)</span> 
                    oImg<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>oImg<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                    oImg<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'å›¾ç‰‡åˆ›å»ºå¤±è´¥'</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æˆªå›¾å¤±è´¥:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span> 
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h2 id="domtoimage-å›¾ç‰‡ç”Ÿæˆå·¥å…·"><a href="#domtoimage-å›¾ç‰‡ç”Ÿæˆå·¥å…·" class="header-anchor">#</a> domtoimage å›¾ç‰‡ç”Ÿæˆå·¥å…·</h2> <p><code>domtoimage.js</code>æ˜¯ä¸€æ¬¾è½»é‡çº§çš„æ’ä»¶ï¼Œå®ƒå¯ä»¥è½»æ¾åœ°å¸®ä½ å°†<code>DOM</code>å…ƒç´ è½¬æ¢æˆå›¾ç‰‡ã€‚</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>zh-CN<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/dom-to-image/dist/dom-to-image.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>qianduanwz<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">background</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>æˆªå›¾å†…å®¹<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
            <span class="token comment">// ä½¿ç”¨ç«‹å³æ‰§è¡Œå¼‚æ­¥å‡½æ•°ï¼Œä»¥ä¾¿ä½¿ç”¨ await</span>
            <span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token keyword">const</span> targetElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'qianduanwz'</span><span class="token punctuation">)</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>targetElement<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">return</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">const</span> imgData <span class="token operator">=</span> <span class="token keyword">await</span> domtoimage<span class="token punctuation">.</span><span class="token function">toJpeg</span><span class="token punctuation">(</span>targetElement<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">quality</span><span class="token operator">:</span> <span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token comment">// å›¾åƒè´¨é‡ï¼Œå¯¹åº” html2canvas ä¸­ toDataURL çš„ç¬¬äºŒä¸ªå‚æ•°</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">let</span> oImg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    oImg<span class="token punctuation">.</span>src <span class="token operator">=</span> imgData
                    oImg<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>oImg<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                    oImg<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'å›¾ç‰‡åˆ›å»ºå¤±è´¥'</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æˆªå›¾å¤±è´¥:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span> 
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h2 id="puppeteer-æ— å¤´æµè§ˆå™¨"><a href="#puppeteer-æ— å¤´æµè§ˆå™¨" class="header-anchor">#</a> puppeteer æ— å¤´æµè§ˆå™¨</h2> <p><code>puppeteer</code>æ˜¯ä¸€æ¬¾åŸºäº<code>Chrome</code>çš„æ— å¤´æµè§ˆå™¨ï¼Œå®ƒå¯ä»¥è®©ä½ åœ¨<code>Node.js</code>ç¯å¢ƒä¸­æ§åˆ¶<code>Chrome</code>æµè§ˆå™¨ï¼Œå®ç°è‡ªåŠ¨åŒ–æ“ä½œã€‚</p> <h3 id="ä»€ä¹ˆæ˜¯æ— å¤´æµè§ˆå™¨"><a href="#ä»€ä¹ˆæ˜¯æ— å¤´æµè§ˆå™¨" class="header-anchor">#</a> ä»€ä¹ˆæ˜¯æ— å¤´æµè§ˆå™¨</h3> <p>æ— å¤´æµè§ˆå™¨æ˜¯ä¸€ç§æ²¡æœ‰ç•Œé¢çš„æµè§ˆå™¨ï¼Œé€šå¸¸ç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•ã€çˆ¬è™«ç­‰åœºæ™¯ã€‚</p> <h3 id="puppeteerçš„ä½¿ç”¨"><a href="#puppeteerçš„ä½¿ç”¨" class="header-anchor">#</a> puppeteerçš„ä½¿ç”¨</h3> <p><code>puppeteer</code>çš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œåªéœ€è¦å®‰è£…<code>puppeteer</code>åŒ…ï¼Œç„¶åä½¿ç”¨<code>puppeteer.launch()</code>æ–¹æ³•å¯åŠ¨æµè§ˆå™¨ï¼Œå†ä½¿ç”¨<code>page.goto()</code>æ–¹æ³•è·³è½¬åˆ°æŒ‡å®šé¡µé¢ï¼Œæœ€åä½¿ç”¨<code>page.screenshot()</code>æ–¹æ³•æˆªå›¾ã€‚</p> <h4 id="puppeteerçš„å®‰è£…"><a href="#puppeteerçš„å®‰è£…" class="header-anchor">#</a> puppeteerçš„å®‰è£…</h4> <p><code>puppeteer</code>ä¸èƒ½é€šè¿‡åœ°å€ç›´æ¥å¼•ç”¨ï¼Œéœ€è¦å…ˆå®‰è£…<code>puppeteer</code>åŒ…ï¼Œç„¶åå†å¼•ç”¨ã€‚</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> puppeteer
<span class="token comment"># æˆ–è€…ä½¿ç”¨yarn</span>
<span class="token function">yarn</span> <span class="token function">add</span> puppeteer
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="åˆ›å»ºè„šæœ¬"><a href="#åˆ›å»ºè„šæœ¬" class="header-anchor">#</a> åˆ›å»ºè„šæœ¬</h4> <p>åˆ›å»ºä¸€ä¸ªæ–°çš„<code>JavaScript</code>æ–‡ä»¶ï¼Œä¾‹å¦‚<code>puppeteer.js</code>ï¼Œç„¶åè¾“å…¥ä»¥ä¸‹ä»£ç ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> puppeteer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'puppeteer'</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¯åŠ¨æµè§ˆå™¨å®ä¾‹</span>
    <span class="token keyword">const</span> browser <span class="token operator">=</span> <span class="token keyword">await</span> puppeteer<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// é»˜è®¤æƒ…å†µä¸‹ï¼ŒPuppeteerä»¥æ— å¤´æ¨¡å¼å¯åŠ¨Chrome</span>
    <span class="token keyword">const</span> page <span class="token operator">=</span> <span class="token keyword">await</span> browser<span class="token punctuation">.</span><span class="token function">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// è®¿é—®æŒ‡å®šç½‘å€</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">goto</span><span class="token punctuation">(</span><span class="token string">'https://example.com'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">waitUntil</span><span class="token operator">:</span> <span class="token string">'networkidle2'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// è®¾ç½®è§†çª—å¤§å°</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">setViewport</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">1920</span><span class="token punctuation">,</span>
        <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">1080</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// æˆªå›¾å¹¶ä¿å­˜åˆ°å½“å‰ç›®å½•</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'example.png'</span><span class="token punctuation">,</span> <span class="token literal-property property">fullPage</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æˆªå›¾å·²ä¿å­˜ä¸º example.png'</span><span class="token punctuation">)</span>

    <span class="token comment">// å…³é—­æµè§ˆå™¨</span>
    <span class="token keyword">await</span> browser<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="è¿è¡Œè„šæœ¬"><a href="#è¿è¡Œè„šæœ¬" class="header-anchor">#</a> è¿è¡Œè„šæœ¬</h4> <p>åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">node</span> puppeteer.js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ åº”è¯¥ä¼šåœ¨å½“å‰ç›®å½•ä¸­çœ‹åˆ°ä¸€ä¸ªåä¸º<code>example.png</code>çš„æ–‡ä»¶ï¼Œå®ƒæ˜¯<code>URL_ADDRESSå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ åº”è¯¥ä¼šåœ¨å½“å‰ç›®å½•ä¸­çœ‹åˆ°ä¸€ä¸ªåä¸º</code>example.png<code>çš„æ–‡ä»¶ï¼Œå®ƒæ˜¯</code>https://example.com`é¡µé¢çš„æˆªå›¾ã€‚</p> <h4 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="header-anchor">#</a> æ³¨æ„äº‹é¡¹</h4> <ul><li><p><code>puppeteer</code>ä½¿ç”¨æ—¶nodeç‰ˆæœ¬éœ€è¦å¤§äºç­‰äº18ä¸ç„¶ä¼šå‡ºç°ä»¥ä¸‹æŠ¥é”™
<img src="/blog/assets/img/puppeteer-nodeç‰ˆæœ¬è¿‡ä½.31d7d8de.png"></p></li> <li><p><code>puppeteer</code>ä½¿ç”¨æ—¶å¦‚æœæ‰¾ä¸åˆ°å‡ºç°ä»¥ä¸‹æŠ¥é”™ï¼Œåˆ™è¯´æ˜<code>puppeteer</code>åœ¨å®‰è£…æ—¶æ²¡æœ‰ä¸‹è½½<code>chromium</code>ï¼Œéœ€è¦é‡æ–°å®‰è£…<code>puppeteer.js</code> <img src="/blog/assets/img/puppeteer-æ‰¾ä¸åˆ°æµè§ˆå™¨.ee3eaf4c.png"></p></li></ul> <h3 id="puppeteer-coreçš„ä½¿ç”¨åœºæ™¯"><a href="#puppeteer-coreçš„ä½¿ç”¨åœºæ™¯" class="header-anchor">#</a> puppeteer-coreçš„ä½¿ç”¨åœºæ™¯</h3> <p>å¦‚æœä½ æƒ³å®‰è£…ä¸€ä¸ªæ›´è½»é‡çº§çš„ç‰ˆæœ¬ï¼ŒåªåŒ…å«åŸºæœ¬çš„æµè§ˆå™¨åŠŸèƒ½è€Œä¸åŒ…æ‹¬é»˜è®¤çš„<code>Chromium</code>æµè§ˆå™¨ï¼ˆé€‚ç”¨äºä½ è®¡åˆ’ä½¿ç”¨è‡ªå·±çš„<code>Chrome/Chromium</code>å®ä¾‹çš„æƒ…å†µï¼‰ï¼Œä½ å¯ä»¥å®‰è£…<code>puppeteer-core</code>ï¼š</p> <p>å®‰è£…/ä½¿ç”¨æ–¹å¼å’Œ<code>puppeteer</code>ä¸€æ ·ï¼Œåªéœ€è¦å°†<code>puppeteer</code>æ›¿æ¢ä¸º<code>puppeteer-core</code>å³å¯ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> puppeteer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'puppeteer-core'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">getChromePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> platform <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">platform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>platform<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'win32'</span><span class="token operator">:</span>
            <span class="token keyword">const</span> possiblePaths <span class="token operator">=</span> <span class="token punctuation">[</span>
                <span class="token string">'C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe'</span><span class="token punctuation">,</span>
                <span class="token string">'C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe'</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> possiblePath <span class="token keyword">of</span> possiblePaths<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>possiblePath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> possiblePath
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'darwin'</span><span class="token operator">:</span>
            <span class="token keyword">const</span> macPath <span class="token operator">=</span> <span class="token string">'/Applications/Google Chrome.app/Contents/MacOS/Google Chrome'</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>macPath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> macPath
            <span class="token punctuation">}</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'linux'</span><span class="token operator">:</span>
            <span class="token keyword">const</span> linuxPaths <span class="token operator">=</span> <span class="token punctuation">[</span>
                <span class="token string">'/usr/bin/google-chrome'</span><span class="token punctuation">,</span>
                <span class="token string">'/usr/bin/chromium-browser'</span><span class="token punctuation">,</span>
                <span class="token string">'/usr/local/bin/chromium'</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> linuxPath <span class="token keyword">of</span> linuxPaths<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>linuxPath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> linuxPath
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> chromePath <span class="token operator">=</span> <span class="token function">getChromePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>chromePath<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æœªæ‰¾åˆ° Chrome å®‰è£…è·¯å¾„ï¼Œæ— æ³•ç»§ç»­æ‰§è¡Œã€‚'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> browser <span class="token operator">=</span> <span class="token keyword">await</span> puppeteer<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">executablePath</span><span class="token operator">:</span> chromePath<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> page <span class="token operator">=</span> <span class="token keyword">await</span> browser<span class="token punctuation">.</span><span class="token function">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">goto</span><span class="token punctuation">(</span><span class="token string">'https://example.com'</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> desktopPath <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">homedir</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'/Desktop'</span>
    <span class="token keyword">const</span> screenshotPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>desktopPath<span class="token punctuation">,</span> <span class="token string">'example.png'</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> screenshotPath <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">await</span> browser<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><h2 id="jspdfè½¬pdfå·¥å…·"><a href="#jspdfè½¬pdfå·¥å…·" class="header-anchor">#</a> jspdfè½¬pdfå·¥å…·</h2> <p><code>jspdf.js</code>å·¥å…·æ™®éçš„ä½¿ç”¨åœºæ™¯ä¸ºï¼Œçº¯å‰ç«¯å°†é¡µé¢ä¸Šçš„å…ƒç´ å¯¼å‡ºä¸º<code>pdf</code>,å½“é‡åˆ°è¿™ç§åœºæ™¯æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ­é…ç€<code>html2canvas.js</code>ä¸€èµ·ä½¿ç”¨ã€‚</p> <ul><li>1.å°†htmlå…ƒç´ é€šè¿‡html2canvas.jsè½¬æ¢ä¸ºcanvas</li> <li>2.å°†canvasé€šè¿‡jspdf.jsè½¬æ¢ä¸ºpdf</li> <li>3.ä¸‹è½½åˆ°æœ¬åœ°</li></ul> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bill-entry<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>genpdf<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> html2Canvas <span class="token keyword">from</span> <span class="token string">&quot;html2canvas&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> JsPDF <span class="token keyword">from</span> <span class="token string">&quot;jspdf&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä¸‹è½½ç”Ÿæˆpdf</span>
    <span class="token comment">// æ ¡éªŒæŠ¥ä»·å•æ˜¯å¦æœ‰å¡«å†™</span>
    <span class="token keyword">async</span> <span class="token function">downloadPdf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">html2Canvas</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#genpdf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">allowTaint</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">useCORS</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// allowTaintã€useCORSåªèƒ½å¤Ÿå‡ºç°ä¸€ä¸ª</span>
        <span class="token literal-property property">imageTimeout</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token literal-property property">dpi</span><span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token comment">// åƒç´ </span>
        <span class="token literal-property property">scale</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment">// å›¾ç‰‡å¤§å°</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">canvas</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ç”¨äºå°†canvaså¯¹è±¡è½¬æ¢ä¸ºbase64ä½ç¼–ç </span>
        <span class="token keyword">let</span> pageData <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&quot;image/jpeg&quot;</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            canvasWidth <span class="token operator">=</span> canvas<span class="token punctuation">.</span>width<span class="token punctuation">,</span>
            canvasHeight <span class="token operator">=</span> canvas<span class="token punctuation">.</span>height<span class="token punctuation">,</span>
            concentWidth <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">,</span>
            concentHeight <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>concentWidth <span class="token operator">/</span> canvasWidth<span class="token punctuation">)</span> <span class="token operator">*</span> canvasHeight<span class="token punctuation">)</span><span class="token punctuation">,</span>
            position <span class="token operator">=</span> <span class="token number">72</span><span class="token punctuation">,</span>
            pageHeight <span class="token operator">=</span> <span class="token number">892</span><span class="token punctuation">,</span>
            height <span class="token operator">=</span> concentHeight<span class="token punctuation">;</span>
        <span class="token comment">// æ–°å»ºä¸€ä¸ªnew JsPDFï¼ŒA3çš„åƒç´ å¤§å° 842*1191ï¼ŒA4çš„åƒç´ å¤§å° 592*841ã€‚è¿™ä¸ªpxåƒç´ ä¸å‡†ç¡®ï¼Œä¸æ¸…æ¥šä»–ä»¬çš„åƒç´ å¤§å°æ¥æºå¦‚ä½•</span>
        <span class="token keyword">let</span> <span class="token constant">PDF</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JsPDF</span><span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>height <span class="token operator">&lt;=</span> pageHeight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ·»åŠ å›¾ç‰‡</span>
            <span class="token constant">PDF</span><span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span>
                pageData<span class="token punctuation">,</span>
                <span class="token string">&quot;JPEG&quot;</span><span class="token punctuation">,</span>
                <span class="token number">68</span><span class="token punctuation">,</span>
                position<span class="token punctuation">,</span>
                concentWidth<span class="token punctuation">,</span>
                concentHeight
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">while</span> <span class="token punctuation">(</span>height <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token constant">PDF</span><span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span>
                  pageData<span class="token punctuation">,</span>
                  <span class="token string">&quot;JPEG&quot;</span><span class="token punctuation">,</span>
                  <span class="token number">68</span><span class="token punctuation">,</span>
                  position<span class="token punctuation">,</span>
                  concentWidth<span class="token punctuation">,</span>
                  concentHeight
              <span class="token punctuation">)</span><span class="token punctuation">;</span>
              height <span class="token operator">-=</span> pageHeight<span class="token punctuation">;</span>
              position <span class="token operator">-=</span> pageHeight<span class="token punctuation">;</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>height <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  <span class="token constant">PDF</span><span class="token punctuation">.</span><span class="token function">addPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token comment">// ä¿å­˜ pdf æ–‡æ¡£</span>
        <span class="token constant">PDF</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token string">&quot;æµ‹è¯•&quot;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.pdf</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><h2 id="html2pdf-å®ç°é¢„è§ˆã€ä¸‹è½½ã€æ‰“å°"><a href="#html2pdf-å®ç°é¢„è§ˆã€ä¸‹è½½ã€æ‰“å°" class="header-anchor">#</a> html2pdf å®ç°é¢„è§ˆã€ä¸‹è½½ã€æ‰“å°</h2> <p><code>vue-html2pdf</code>çš„é€‚ç”¨åœºæ™¯ä¸ºï¼Œåœ¨å¼¹çª—ä¸­å…ˆé¢„è§ˆå†…å®¹ï¼Œå¹¶ä¸”æ”¯æŒä¸‹è½½ã€æ‰“å°åŠŸèƒ½ã€‚</p> <details><summary><b>vue-html2pdfçš„ä½¿ç”¨æ–¹æ³•</b></summary> <p>ä½¿ç”¨å±æ€§</p> <table><thead><tr><th style="text-align:center;">å±æ€§</th> <th style="text-align:center;">å€¼</th> <th style="text-align:center;">æè¿°</th> <th style="text-align:center;">å»ºè®®</th></tr></thead> <tbody><tr><td style="text-align:center;">show-layout</td> <td style="text-align:center;">true/false</td> <td style="text-align:center;">æ˜¯å¦æ˜¾ç¤ºè¦è½¬ä¸º PDF çš„å…ƒç´ </td> <td style="text-align:center;">è°ƒå¼è¦è½¬å‡ºçš„å…ƒç´ çš„å¸ƒå±€æ—¶ trueï¼Œå¹³æ—¶ false</td></tr> <tr><td style="text-align:center;">float-layout</td> <td style="text-align:center;">true/false</td> <td style="text-align:center;">å¦‚æœé“å…·è®¾ç½®ä¸º false é“å…· show-layout å°†è¢«è¦†ç›–ã€‚å¸ƒå±€ä¸ä¼šæµ®åŠ¨ï¼Œå¹¶ä¸”å¸ƒå±€å°†å§‹ç»ˆæ˜¾ç¤ºã€‚</td> <td style="text-align:center;">æˆ‘ä¸€ç›´ä½¿ç”¨çš„ trueï¼Œå› ä¸ºåšçš„æ—¶å€™åšäº†ä¸¤ä»½ï¼Œä¸€ä¸ªæ˜¯åœ¨åå°æ˜¾ç¤ºçš„ï¼Œä¸€ä¸ªæ˜¯å¯¼å‡ºä¸º PDF çš„ï¼Œå¸ƒå±€ä¸ä¸€æ ·</td></tr> <tr><td style="text-align:center;">enable-download</td> <td style="text-align:center;">true/false</td> <td style="text-align:center;">æ˜¯å¦å¼¹å‡ºè½¬ PDF åçš„é¢„è§ˆæ¨¡æ¿ï¼Œä¸º true æ—¶è°ƒç”¨ä¸Šé¢çš„ä¸‹è½½æ–¹æ³•é»˜è®¤å¼¹å‡ºé¢„è§ˆæ¨¡æ¿</td> <td style="text-align:center;">è°ƒè¯•æ—¶å¼€å¯ï¼Œå®Œå·¥åå…³é—­</td></tr> <tr><td style="text-align:center;">preview-modal</td> <td style="text-align:center;">true/false</td> <td style="text-align:center;">æ˜¯å¦å¼¹å‡ºè½¬ PDF åçš„é¢„è§ˆæ¨¡æ¿ï¼Œä¸º true æ—¶è°ƒç”¨ä¸Šé¢çš„ä¸‹è½½æ–¹æ³•é»˜è®¤å¼¹å‡ºé¢„è§ˆæ¨¡æ¿</td> <td style="text-align:center;">è°ƒè¯•æ—¶å¼€å¯ï¼Œå®Œå·¥åå…³é—­</td></tr> <tr><td style="text-align:center;">paginate-elements-by-height</td> <td style="text-align:center;">ä»»ä½•æ•°å­—</td> <td style="text-align:center;">è¾“å…¥çš„æ•°å­—å°†ç”¨äºå¯¹å…ƒç´ è¿›è¡Œåˆ†é¡µï¼Œæ•°å­—ä»…ä»¥ px ä¸ºå•ä½ã€‚</td> <td style="text-align:center;">å®˜æ–¹é»˜è®¤ 1400ï¼Œæ²¡åŠ¨è¿‡</td></tr> <tr><td style="text-align:center;">filename</td> <td style="text-align:center;">ä»»ä½•å­—ç¬¦ä¸²</td> <td style="text-align:center;">å¯¼å‡ºåçš„é»˜è®¤ PDF æ–‡ä»¶å</td> <td style="text-align:center;">è‡ªå®šä¹‰</td></tr> <tr><td style="text-align:center;">pdf-quality</td> <td style="text-align:center;">0 - 2ï¼ˆå¯ä»¥æœ‰å°æ•°ï¼‰</td> <td style="text-align:center;">2 æ˜¯æœ€é«˜è´¨é‡ï¼Œ0.1 æ˜¯æœ€ä½è´¨é‡ï¼Œ0 å°†ä½¿ PDF æ¶ˆå¤±ã€‚</td> <td style="text-align:center;">å®˜æ–¹è™½ç„¶è¯´æ˜¯ 0~2ï¼Œä½†æ˜¯æˆ‘è°ƒ 5 ä¹Ÿæ˜¯æ›´é«˜æ¸…äº†</td></tr> <tr><td style="text-align:center;">manual-pagination</td> <td style="text-align:center;">true/false</td> <td style="text-align:center;">ä¸º true æ—¶ä¸ä¼šè‡ªåŠ¨å¯¹å…ƒç´ è¿›è¡Œåˆ†é¡µã€‚ä¸º false æ—¶åˆ†é¡µå°†ä¾èµ–äºå…·æœ‰â€œhtml2pdf__page-breakâ€ç±»çš„å…ƒç´ æ¥çŸ¥é“åœ¨å“ªé‡Œåˆ†é¡µï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢æ‰€å†™çš„</td> <td style="text-align:center;">æˆ‘ä¸€ç›´ä½¿ç”¨çš„ falseï¼Œçœ‹éœ€æ±‚</td></tr> <tr><td style="text-align:center;">pdf-format</td> <td style="text-align:center;">a0, a1, a2, a3, a4, letter, legal, a5, a6, a7, a8, a9, a10</td> <td style="text-align:center;">è¿™æ˜¯ PDF æ ¼å¼ï¼ˆçº¸å¼ å°ºå¯¸ï¼‰</td> <td style="text-align:center;">ä¸€èˆ¬éƒ½ç”¨çš„a4ï¼Œæ‰€ä»¥ a4</td></tr> <tr><td style="text-align:center;">pdf-orientation</td> <td style="text-align:center;">portrait, landscape</td> <td style="text-align:center;">PDF æ–¹å‘ï¼Œlandscape æ˜¯æ¨ªå‘ï¼Œportrait æ˜¯çºµå‘</td> <td style="text-align:center;">çœ‹éœ€æ±‚</td></tr> <tr><td style="text-align:center;">pdf-content-width</td> <td style="text-align:center;">ä»»ä½• css å°ºå¯¸ï¼ˆä¾‹å¦‚â€œ800pxâ€ã€â€œ65vwâ€ã€â€œ70%â€ï¼‰</td> <td style="text-align:center;">PDF å†…å®¹å®½åº¦</td> <td style="text-align:center;">800px åº”è¯¥æ˜¯ a4 æœ€å¤§çš„å°ºå¯¸ï¼Œå…·ä½“è¾¹è·æˆ‘ä½¿ç”¨çš„ padding</td></tr></tbody></table> <p><strong>æ‰‹åŠ¨åˆ†é¡µ</strong></p> <ul><li>éœ€è¦åˆ†é¡µçš„å†…å®¹ç”¨divåŒ…è£¹èµ·æ¥å¹¶ç»™<code>html2pdf__page-break</code>å±æ€§å</li></ul> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preview<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é¢„è§ˆ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">height</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html2pdf</span>
                <span class="token attr-name">:show-layout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">:float-layout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">:enable-download</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">:preview-modal</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">:paginate-elements-by-height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3000<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">:pdf-quality</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">:manual-pagination</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">pdf-format</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>a4<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">pdf-orientation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>portrait<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">pdf-content-width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100%<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>html2Pdf<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pdf-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>html2pdf__page-break page-one<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>é¡¹ç›®ç»ç†è´£ä»»ä¹¦1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row-one<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é¡¹ç›®ç»ç†: {{ 'å°æ˜' }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row-two<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ `åœ¨å…¬å¸è§„å®šçš„å®æ–½æˆæœ¬2000000å…ƒï¼ˆåŒ…å«é£é™©ä¿éšœé‡‘200000'å…ƒã€è¿ç»´è®¡åˆ’æˆæœ¬300000å…ƒï¼‰å†…ï¼Œä½¿ç”¨å…¬å¸è®¤å¯çš„æŠ€æœ¯è·¯çº¿ã€å®æ–½æ–¹æ³•ï¼ŒæŒ‰æœŸå®ŒæˆåˆåŒè§„å®šçš„é¡¹ç›®äº¤ä»˜å·¥ä½œï¼Œå®æ–½æˆæœ¬ç›ˆä½™éƒ¨åˆ†ç”±é¡¹ç›®ç»ç†å…¨æƒè´Ÿè´£åˆ†é…ã€‚` }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row-three<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>å‚è€ƒèµ„æ–™:ã€Šxxxé¡¹ç›®ç»ç†åŒ…å¹²åˆ¶ç®¡ç†åˆ¶åº¦ã€‹ã€Šxxxé¡¹ç›®ç»ç†åŒ…å¹²åˆ¶å®æ–½æ¨¡æ¿ã€‹<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row-four<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é¡¹ç›®ç»ç†:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row-five<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é¡¹ç›®ç®¡ç†åŠå…¬å®¤:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row-six<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>è´¢åŠ¡åŠå…¬å®¤:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row-seven<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>ç­¾è®¢æ—¥æœŸ:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>html2pdf__page-break page-one<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>é¡¹ç›®ç»ç†è´£ä»»ä¹¦2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row-one<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é¡¹ç›®ç»ç†: {{ 'å°æ˜' }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row-two<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ `åœ¨å…¬å¸è§„å®šçš„å®æ–½æˆæœ¬2000000å…ƒï¼ˆåŒ…å«é£é™©ä¿éšœé‡‘200000å…ƒã€è¿ç»´è®¡åˆ’æˆæœ¬300000å…ƒï¼‰å†…ï¼Œä½¿ç”¨å…¬å¸è®¤å¯çš„æŠ€æœ¯è·¯çº¿ã€å®æ–½æ–¹æ³•ï¼ŒæŒ‰æœŸå®ŒæˆåˆåŒè§„å®šçš„é¡¹ç›®äº¤ä»˜å·¥ä½œï¼Œå®æ–½æˆæœ¬ç›ˆä½™éƒ¨åˆ†ç”±é¡¹ç›®ç»ç†å…¨æƒè´Ÿè´£åˆ†é…ã€‚` }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row-three<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>å‚è€ƒèµ„æ–™:ã€Šxxxé¡¹ç›®ç»ç†åŒ…å¹²åˆ¶ç®¡ç†åˆ¶åº¦ã€‹ã€Šxxxé¡¹ç›®ç»ç†åŒ…å¹²åˆ¶å®æ–½æ¨¡æ¿ã€‹<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row-four<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é¡¹ç›®ç»ç†:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row-five<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é¡¹ç›®ç®¡ç†åŠå…¬å®¤:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row-six<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>è´¢åŠ¡åŠå…¬å®¤:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row-seven<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>ç­¾è®¢æ—¥æœŸ:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html2pdf</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> html2pdf <span class="token keyword">from</span> <span class="token string">'vue-html2pdf'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">methods</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// é¢„è§ˆ</span>
        <span class="token function">preview</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>html2Pdf<span class="token punctuation">.</span><span class="token function">generatePdf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">.page-one</span> <span class="token punctuation">{</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> 20% 15% 0 15%<span class="token punctuation">;</span>
        <span class="token property">letter-spacing</span><span class="token punctuation">:</span> 2px<span class="token punctuation">;</span>

        <span class="token selector">h1</span> <span class="token punctuation">{</span>
            <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
            <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token selector">p</span> <span class="token punctuation">{</span>
            <span class="token property">font-size</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
            <span class="token property">padding</span><span class="token punctuation">:</span> 5px 0<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token selector">.row-one</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token selector">.row-two</span> <span class="token punctuation">{</span>
            <span class="token property">text-indent</span><span class="token punctuation">:</span> 4ch<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token selector">.row-three</span> <span class="token punctuation">{</span>
            <span class="token property">text-indent</span><span class="token punctuation">:</span> 4ch<span class="token punctuation">;</span>
            <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token selector">.row-four</span> <span class="token punctuation">{</span>
            <span class="token property">text-indent</span><span class="token punctuation">:</span> 20ch<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token selector">.row-five</span> <span class="token punctuation">{</span>
            <span class="token property">text-indent</span><span class="token punctuation">:</span> 20ch<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token selector">.row-six</span> <span class="token punctuation">{</span>
            <span class="token property">text-indent</span><span class="token punctuation">:</span> 20ch<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token selector">.row-seven</span> <span class="token punctuation">{</span>
            <span class="token property">text-indent</span><span class="token punctuation">:</span> 20ch<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br></div></div></details> <h2 id="pdfjs-dist-å®ç°pdfé¢„è§ˆ"><a href="#pdfjs-dist-å®ç°pdfé¢„è§ˆ" class="header-anchor">#</a> pdfjs-dist å®ç°pdfé¢„è§ˆ</h2> <p><code>pdfjs-dist</code>å¯ä»¥å°†æ–‡ä»¶æœåŠ¡å™¨æˆ–è€…æœ¬åœ°çš„pdfï¼Œå±•ç¤ºåœ¨é¡¹ç›®ä¸­ï¼Œéœ€è¦æ ¹æ®é¡¹ç›®æƒ…å†µä½¿ç”¨ã€‚
</p><details><summary><b>pdfjs-distçš„ä½¿ç”¨æ–¹æ³•</b></summary>
å¼•å…¥pdfjs-dist:<p></p> <ol><li>åœ¨çº¿å¼•å…¥ï¼š<code>&lt;script src=&quot;https://cdn.jsdelivr.net/npm/pdfjs-dist@2.14.305/build/pdf.min.js&quot;&gt;&lt;/script&gt;</code></li> <li>npm: npm install pdfjs-dist</li> <li>yarn: yarn add pdfjs-dist</li></ol> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pdf-preview-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(page, index) in pdfPages<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>pdf-page-' + index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">import</span> pdfjsLib <span class="token keyword">from</span> <span class="token string">'pdfjs-dist'</span>
    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token comment">// æŸ¥çœ‹æ–‡ä»¶</span>
                <span class="token literal-property property">fileviewUrl</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_API_FILE</span><span class="token punctuation">,</span>
                <span class="token literal-property property">filePath</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token literal-property property">fileType</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
                <span class="token literal-property property">pdfPages</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token literal-property property">currentPage</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token literal-property property">totalPages</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemData</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'/8107aee9-d307-4621-adeb-3ae5c65a7202.pdf'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'æµ‹è¯•.pdf'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">downloadFile</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemData<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token keyword">async</span> <span class="token function">downloadFile</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>filePath <span class="token operator">=</span> item<span class="token punctuation">.</span>url
                <span class="token keyword">this</span><span class="token punctuation">.</span>fileType <span class="token operator">=</span> item<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileType <span class="token operator">===</span> <span class="token string">'pdf'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token keyword">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                        <span class="token keyword">const</span> loadingTask <span class="token operator">=</span> pdfjsLib<span class="token punctuation">.</span><span class="token function">getDocument</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileviewUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>filePath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
                        <span class="token keyword">const</span> pdf <span class="token operator">=</span> <span class="token keyword">await</span> loadingTask<span class="token punctuation">.</span>promise
                        <span class="token keyword">this</span><span class="token punctuation">.</span>totalPages <span class="token operator">=</span> pdf<span class="token punctuation">.</span>numPages
                        <span class="token keyword">this</span><span class="token punctuation">.</span>pdfPages <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>totalPages <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>

                        <span class="token comment">// ä½¿ç”¨å¾ªç¯æ¸²æŸ“æ‰€æœ‰é¡µé¢</span>
                        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentPage <span class="token operator">&lt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>totalPages<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderPage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentPage<span class="token punctuation">)</span>
                            <span class="token keyword">this</span><span class="token punctuation">.</span>currentPage<span class="token operator">++</span>
                        <span class="token punctuation">}</span>
                        <span class="token comment">// æ¸²æŸ“å®Œæˆåï¼Œå°†å½“å‰é¡µé‡ç½®ä¸ºç¬¬ä¸€é¡µ</span>
                        <span class="token keyword">this</span><span class="token punctuation">.</span>currentPage <span class="token operator">=</span> <span class="token number">1</span>
                        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderPage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentPage<span class="token punctuation">)</span>

                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>$Message<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'æš‚ä¸æ”¯æŒè¯¥æ–‡ä»¶ç±»å‹'</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token keyword">async</span> <span class="token function">renderPage</span><span class="token punctuation">(</span><span class="token parameter">pageNumber<span class="token punctuation">,</span> first</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">const</span> loadingTask <span class="token operator">=</span> pdfjsLib<span class="token punctuation">.</span><span class="token function">getDocument</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileviewUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>filePath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
                <span class="token keyword">const</span> pdf <span class="token operator">=</span> <span class="token keyword">await</span> loadingTask<span class="token punctuation">.</span>promise
                <span class="token keyword">const</span> page <span class="token operator">=</span> <span class="token keyword">await</span> pdf<span class="token punctuation">.</span><span class="token function">getPage</span><span class="token punctuation">(</span>pageNumber<span class="token punctuation">)</span>

                <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pdf-page-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageNumber <span class="token operator">-</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
                <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
                <span class="token comment">// scaleè¶Šå¤§ï¼Œå›¾ç‰‡è¶Šæ¸…æ™°ï¼Œä½†æ˜¯å›¾ç‰‡è¶Šå¤§ï¼ŒåŠ è½½æ—¶é—´è¶Šé•¿</span>
                <span class="token keyword">const</span> viewport <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token function">getViewport</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">scale</span><span class="token operator">:</span> <span class="token number">4.0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> viewport<span class="token punctuation">.</span>height
                canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> viewport<span class="token punctuation">.</span>width

                <span class="token keyword">const</span> renderContext <span class="token operator">=</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">canvasContext</span><span class="token operator">:</span> ctx<span class="token punctuation">,</span>
                    <span class="token literal-property property">viewport</span><span class="token operator">:</span> viewport
                <span class="token punctuation">}</span>
                <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>renderContext<span class="token punctuation">)</span><span class="token punctuation">.</span>promise
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">#pdf-preview-container</span> <span class="token punctuation">{</span>
    <span class="token selector">canvas</span> <span class="token punctuation">{</span>
        <span class="token property">max-width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
        <span class="token property">max-height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br></div></div></details> <h2 id="xlsx-å®ç°çº¿ä¸Šxlsxé¢„è§ˆ"><a href="#xlsx-å®ç°çº¿ä¸Šxlsxé¢„è§ˆ" class="header-anchor">#</a> xlsx å®ç°çº¿ä¸Šxlsxé¢„è§ˆ</h2> <p>xlsxå¯ä»¥å°†æ–‡ä»¶æœåŠ¡å™¨æˆ–è€…æœ¬åœ°çš„excelï¼Œå±•ç¤ºåœ¨é¡¹ç›®ä¸­ï¼Œéœ€è¦æ ¹æ®é¡¹ç›®æƒ…å†µä½¿ç”¨ã€‚</p> <p><strong>æ³¨æ„è¯¥æ–¹æ¡ˆä¸é€‚ç”¨äºexcelä¸­æœ‰å›¾ç‰‡å’Œå¤šsheeté¡µæƒ…å†µï¼Œå¦‚æœéœ€è¦é¢„è§ˆä¸Šè¿°å†…å®¹å¯ä»¥é‡‡ç”¨iframeåµŒå¥—Microsoft Office Online Viewerã€Google Docs Viewerç­‰</strong></p><details><summary><b>xlsxçš„ä½¿ç”¨æ–¹æ³•</b></summary>
å¼•å…¥xlsx:<p></p> <ol><li>åœ¨çº¿å¼•å…¥ï¼š<code>&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js&quot;&gt;&lt;/script&gt;</code></li> <li>npm: npm install xlsx</li> <li>yarn: yarn add xlsx</li></ol> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>excel-preview<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>excel-preview<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">import</span> <span class="token constant">XLSX</span> <span class="token keyword">from</span> <span class="token string">'xlsx'</span>
    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token comment">// æŸ¥çœ‹æ–‡ä»¶</span>
                <span class="token literal-property property">fileviewUrl</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_API_FILE</span><span class="token punctuation">,</span>
                <span class="token literal-property property">filePath</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token literal-property property">fileType</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemData</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'/8107aee9-d307-4621-adeb-3ae5c65a7202.xls'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'æµ‹è¯•.xls'</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">downloadFile</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemData<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token keyword">async</span> <span class="token function">downloadFile</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>filePath <span class="token operator">=</span> item
                <span class="token keyword">this</span><span class="token punctuation">.</span>fileType <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileType <span class="token operator">===</span> <span class="token string">'xls'</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fileType <span class="token operator">===</span> <span class="token string">'xlsx'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// è¯»å– Excel æ–‡ä»¶å¹¶æ¸²æŸ“åˆ°é¡µé¢</span>
                    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileviewUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>filePath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
                    <span class="token keyword">const</span> arrayBuffer <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>arrayBuffer<span class="token punctuation">)</span>
                    <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'array'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token keyword">const</span> excelPreview <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'excel-preview'</span><span class="token punctuation">)</span>
                    excelPreview<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">''</span>
                    <span class="token comment">// éå†æ‰€æœ‰å·¥ä½œè¡¨</span>
                    workbook<span class="token punctuation">.</span>SheetNames<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">sheetName<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                        <span class="token keyword">const</span> worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">[</span>sheetName<span class="token punctuation">]</span>
                        <span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">sheet_to_html</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">)</span>

                        <span class="token comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„ div æ¥åŒ…å«æ¯ä¸ªå·¥ä½œè¡¨</span>
                        <span class="token keyword">const</span> sheetDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
                        sheetDiv<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> html
                        sheetDiv<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'excel-sheet'</span><span class="token punctuation">)</span>

                        <span class="token comment">// ä¸ºæ¯ä¸ªå·¥ä½œè¡¨æ·»åŠ æ ‡é¢˜</span>
                        <span class="token keyword">const</span> title <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'h3'</span><span class="token punctuation">)</span>
                        title<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å·¥ä½œè¡¨ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sheetName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
                        sheetDiv<span class="token punctuation">.</span><span class="token function">prepend</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>

                        excelPreview<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>sheetDiv<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>

                    <span class="token comment">// æ‰‹åŠ¨æ·»åŠ ç±»å</span>
                    <span class="token keyword">const</span> tables <span class="token operator">=</span> excelPreview<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'table'</span><span class="token punctuation">)</span>
                    <span class="token comment">// æ‰‹åŠ¨æ·»åŠ æ ·å¼ï¼Œå› ä¸ºxlsxç”Ÿæˆçš„tableæ˜¯é»˜è®¤æ ·å¼ï¼Œåœ¨æ ·å¼ä¸Šåšè°ƒæ•´å¯èƒ½ä¸ä¼šç”Ÿæ•ˆï¼Œç›´æ¥jsæ·»åŠ æ ·å¼</span>
                    tables<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">table</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                        table<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'excel-table'</span><span class="token punctuation">)</span>
                        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>table<span class="token punctuation">,</span> <span class="token string">'table'</span><span class="token punctuation">)</span>
                        <span class="token comment">// ç»™ table æ·»åŠ æ ·å¼</span>
                        table<span class="token punctuation">.</span>style<span class="token punctuation">.</span>borderCollapse <span class="token operator">=</span> <span class="token string">'collapse'</span>
                        table<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'100%'</span>
                        table<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">'white'</span>
                        <span class="token comment">// è°ƒæ•´é«˜åº¦ä»¥æ’‘æ»¡å¼¹çª—</span>
                        table<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">'calc(100vh - 4rem - 30px)'</span>
                        <span class="token comment">// æ·»åŠ å‚ç›´æ»šåŠ¨æ¡</span>
                        table<span class="token punctuation">.</span>style<span class="token punctuation">.</span>overflow <span class="token operator">=</span> <span class="token string">'auto'</span>
                        <span class="token comment">// table.style.fontSize = '0.6rem'</span>
                        <span class="token comment">// ç»™ table å†…æ‰€æœ‰çš„ trã€td æ·»åŠ æ ·å¼</span>
                        <span class="token keyword">const</span> cells <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'tr, td'</span><span class="token punctuation">)</span>
                        cells<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">cell</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                            cell<span class="token punctuation">.</span>style<span class="token punctuation">.</span>border <span class="token operator">=</span> <span class="token string">'1px solid #ccc'</span>
                            cell<span class="token punctuation">.</span>style<span class="token punctuation">.</span>padding <span class="token operator">=</span> <span class="token string">'0.5rem'</span>
                            cell<span class="token punctuation">.</span>style<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">'center'</span>
                            cell<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> <span class="token string">'0.6rem'</span>
                            <span class="token comment">// æ–‡å­—ä¸æ¢è¡Œ</span>
                            cell<span class="token punctuation">.</span>style<span class="token punctuation">.</span>whiteSpace <span class="token operator">=</span> <span class="token string">'nowrap'</span>
                            cell<span class="token punctuation">.</span>style<span class="token punctuation">.</span>overflow <span class="token operator">=</span> <span class="token string">'hidden'</span>
                            cell<span class="token punctuation">.</span>style<span class="token punctuation">.</span>textOverflow <span class="token operator">=</span> <span class="token string">'ellipsis'</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br></div></div><div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- Microsoft Office Online Viewerçš„ä½¿ç”¨æ–¹æ³•ï¼š --&gt;</span>
<span class="token comment">&lt;!-- æ³¨æ„ï¼šè¿™ç§æ–¹å¼åªé€‚ç”¨äºæ–‡ä»¶å­˜æ”¾åœ¨èƒ½ä½¿ç”¨httpsè®¿é—®é€šçš„æœåŠ¡å™¨ä¸Šï¼Œä¸ç„¶ä¼šå‡ºç°è·¨åŸŸé—®é¢˜ï¼Œå¯¼è‡´æ–‡ä»¶æ— æ³•æ˜¾ç¤º --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span>
        <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>`https://view.officeapps.live.com/op/embed.aspx?src=${fileUrl}`<span class="token punctuation">&quot;</span></span> 
        <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>100vh - 4rem - 30px<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span> 
        <span class="token attr-name">frameborder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">fileUrl</span><span class="token operator">:</span> <span class="token string">'https://baidu.com/8107aee9-d307-4621-adeb-3ae5c65a7202.xls'</span>
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></details> <h2 id="ssh2-archiver-å®ç°ä»£ç è‡ªåŠ¨æ‰“åŒ…ä¸Šä¼ "><a href="#ssh2-archiver-å®ç°ä»£ç è‡ªåŠ¨æ‰“åŒ…ä¸Šä¼ " class="header-anchor">#</a> ssh2 + archiver å®ç°ä»£ç è‡ªåŠ¨æ‰“åŒ…ä¸Šä¼ </h2> <p><code>ssh2</code>æ˜¯è¿æ¥è¿œç¨‹æœåŠ¡å™¨çš„ï¼Œé…ç½®ä¸€äº›åŸºæœ¬çš„æœåŠ¡å™¨é…ç½®</p> <p><code>archiver</code>æ˜¯å‹ç¼©å·¥å…·å‹ç¼©ä¸ºzipæ–‡ä»¶ï¼Œå‡å°‘ä¸Šä¼ æ•°é‡</p> <p>è¿™ç§æ–¹å¼å±äºä¸€é”®å‘å¸ƒï¼Œæ¯”è¾ƒä¾¿æ·ï¼Œåªéœ€è¦è¿è¡Œå‘½ä»¤<code>node ade.js dev</code>ï¼Œå³å¯è‡ªåŠ¨å‘å¸ƒä»£ç åˆ°å¯¹åº”çš„ç¯å¢ƒï¼Œ<code>adp.js</code>ä¸ºä¸‹é¢jsæ–‡ä»¶åï¼Œ<code>dev</code>ä¸ºæƒ³è¦ä¸Šä¼ çš„æœåŠ¡å™¨</p> <details><summary><b>adp.jsæ–‡ä»¶ä»£ç </b></summary> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* eslint-disable space-before-function-paren */</span>
<span class="token comment">/* eslint-disable prefer-promise-reject-errors */</span>
<span class="token comment">// å¼€å‘ç¯å¢ƒ</span>
<span class="token keyword">const</span> envObject <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">dev</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">'192.155.1.120'</span><span class="token punctuation">,</span> <span class="token comment">// æœåŠ¡å™¨ipåœ°å€æˆ–åŸŸå</span>
        <span class="token literal-property property">catalog</span><span class="token operator">:</span> <span class="token string">'/home/web_app/uload'</span><span class="token punctuation">,</span> <span class="token comment">// å‰ç«¯æ–‡ä»¶å‹ç¼©ç›®å½•</span>
        <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token comment">// æœåŠ¡å™¨sshè¿æ¥ç«¯å£å·</span>
        <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token comment">// sshç™»å½•ç”¨æˆ·</span>
        <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">'123456'</span><span class="token punctuation">,</span> <span class="token comment">// å¯†ç </span>
        <span class="token literal-property property">privateKey</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token comment">// ç§é’¥ï¼Œç§é’¥ä¸å¯†ç äºŒé€‰ä¸€</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// çº¿ä¸Šç¯å¢ƒ</span>
    <span class="token literal-property property">prod</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">'130.56.78.251'</span><span class="token punctuation">,</span> <span class="token comment">// æœåŠ¡å™¨ipåœ°å€æˆ–åŸŸå</span>
        <span class="token literal-property property">catalog</span><span class="token operator">:</span> <span class="token string">'/home/web_app/uload'</span><span class="token punctuation">,</span> <span class="token comment">// å‰ç«¯æ–‡ä»¶å‹ç¼©ç›®å½•</span>
        <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token comment">// æœåŠ¡å™¨sshè¿æ¥ç«¯å£å·</span>
        <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token comment">// sshç™»å½•ç”¨æˆ·</span>
        <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">'123456'</span><span class="token punctuation">,</span> <span class="token comment">// å¯†ç </span>
        <span class="token literal-property property">privateKey</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token comment">// ç§é’¥ï¼Œç§é’¥ä¸å¯†ç äºŒé€‰ä¸€</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> pushList <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>envObject<span class="token punctuation">)</span>
<span class="token keyword">const</span> publishEnv <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// æ‰“åŒ…çš„æ•°ç»„åˆ—è¡¨</span>
<span class="token keyword">let</span> buildCommand <span class="token operator">=</span> <span class="token string">''</span>
process<span class="token punctuation">.</span>argv<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">str</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç”±äºé…ç½®çš„å‘½ä»¤ åªèƒ½æ‰“åŒ…ä¸€ä¸ª</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pushList<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> publishEnv<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        buildCommand <span class="token operator">=</span> <span class="token string">'npm run build:'</span> <span class="token operator">+</span> str
        publishEnv<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>envObject<span class="token punctuation">[</span>str<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// å…¨å±€é…ç½®</span>
<span class="token keyword">const</span> Config <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// publishEnv: pro,</span>
    <span class="token comment">// publishEnv: [dev, dev2, ys, xs], // å‘å¸ƒç¯å¢ƒï¼Œå¯å¡«å†™å¤šä¸ªï¼Œä¹Ÿå¯åªå¡«å†™ä¸€ä¸ª</span>
    publishEnv<span class="token punctuation">,</span> <span class="token comment">// å‘å¸ƒç¯å¢ƒï¼Œå¯å¡«å†™å¤šä¸ªï¼Œä¹Ÿå¯åªå¡«å†™ä¸€ä¸ª</span>
    <span class="token literal-property property">buildDist</span><span class="token operator">:</span> <span class="token string">'dist'</span><span class="token punctuation">,</span> <span class="token comment">// å‰ç«¯æ–‡ä»¶æ‰“åŒ…ä¹‹åçš„ç›®å½•ï¼Œé»˜è®¤dist</span>
    <span class="token comment">// buildCommand: 'npm run build', // æ‰“åŒ…å‰ç«¯æ–‡ä»¶çš„å‘½ä»¤</span>
    buildCommand<span class="token punctuation">,</span> <span class="token comment">// æ‰“åŒ…å‰ç«¯æ–‡ä»¶çš„å‘½ä»¤</span>
    <span class="token literal-property property">readyTimeout</span><span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span> <span class="token comment">// sshè¿æ¥è¶…æ—¶æ—¶é—´</span>
    <span class="token literal-property property">deleteFile</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// æ˜¯å¦åˆ é™¤çº¿ä¸Šä¸Šä¼ çš„distå‹ç¼©åŒ…</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> exec <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> archiver <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'archiver'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Client <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ssh2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Client

<span class="token comment">// å‰ç«¯æ‰“åŒ…æ–‡ä»¶çš„ç›®å½•</span>
<span class="token comment">// const dir = path.resolve(__dirname, Config.buildDist)</span>

<span class="token comment">/**
 * sshè¿æ¥
 */</span>
<span class="token keyword">class</span> <span class="token class-name">SSH</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> privateKey<span class="token punctuation">,</span> agent <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>server <span class="token operator">=</span> <span class="token punctuation">{</span>
            host<span class="token punctuation">,</span>
            port<span class="token punctuation">,</span>
            username<span class="token punctuation">,</span>
            password<span class="token punctuation">,</span>
            privateKey
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>hasAgent <span class="token operator">=</span> agent <span class="token operator">&amp;&amp;</span> agent<span class="token punctuation">.</span>host <span class="token operator">&amp;&amp;</span> agent<span class="token punctuation">.</span>port <span class="token operator">&amp;&amp;</span> agent<span class="token punctuation">.</span>username
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>hasAgent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>connAgent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Client</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// è¿æ¥è·³æ¿æœº</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>conn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Client</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// è¿æ¥ç›®æ ‡æœº</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>agent <span class="token operator">=</span> agent
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>conn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Client</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// è¿æ¥æœåŠ¡å™¨</span>
    <span class="token function">connectServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> conn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>conn
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>hasAgent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                conn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>connAgent
            <span class="token punctuation">}</span>
            conn<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>hasAgent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// Alternatively, you could use netcat or socat with exec() instead of</span>
                    <span class="token comment">// forwardOut()</span>

                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----è¿æ¥è·³æ¿æœºæˆåŠŸ----'</span><span class="token punctuation">)</span>
                    conn<span class="token punctuation">.</span><span class="token function">forwardOut</span><span class="token punctuation">(</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token number">12345</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>agent<span class="token punctuation">.</span>host<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>agent<span class="token punctuation">.</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stream</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            conn<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                            <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                                <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                                <span class="token literal-property property">error</span><span class="token operator">:</span> err
                            <span class="token punctuation">}</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span>
                        <span class="token comment">// è¿æ¥ç›®æ ‡æœº</span>
                        <span class="token keyword">this</span><span class="token punctuation">.</span>conn
                            <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----è¿æ¥ç›®æ ‡æœºæˆåŠŸ----'</span><span class="token punctuation">)</span>
                                <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                                    <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">true</span>
                                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                            <span class="token punctuation">}</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                                <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                                    <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                                    <span class="token literal-property property">error</span><span class="token operator">:</span> err
                                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                            <span class="token punctuation">}</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'target ssh connect end!'</span><span class="token punctuation">)</span>
                            <span class="token punctuation">}</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'target ssh connect close'</span><span class="token punctuation">)</span>
                            <span class="token punctuation">}</span><span class="token punctuation">)</span>
                            <span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                                <span class="token literal-property property">sock</span><span class="token operator">:</span> stream<span class="token punctuation">,</span>
                                <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>agent<span class="token punctuation">.</span>username<span class="token punctuation">,</span>
                                <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>agent<span class="token punctuation">.</span>password
                            <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">true</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">error</span><span class="token operator">:</span> err
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----SSHè¿æ¥å·²ç»“æŸ----'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----SSHè¿æ¥å·²å…³é—­----'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>server<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ä¸Šä¼ æ–‡ä»¶</span>
    <span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> localPath<span class="token punctuation">,</span> remotePath <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>conn<span class="token punctuation">.</span><span class="token function">sftp</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> sftp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">error</span><span class="token operator">:</span> err
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    sftp<span class="token punctuation">.</span><span class="token function">fastPut</span><span class="token punctuation">(</span>localPath<span class="token punctuation">,</span> remotePath<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                                <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                                <span class="token literal-property property">error</span><span class="token operator">:</span> err
                            <span class="token punctuation">}</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span>
                        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                            <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                            result
                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æ‰§è¡Œsshå‘½ä»¤</span>
    <span class="token function">execSsh</span><span class="token punctuation">(</span><span class="token parameter">command</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>conn<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stream</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token operator">||</span> <span class="token operator">!</span>stream<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">error</span><span class="token operator">:</span> err
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    stream
                        <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">code<span class="token punctuation">,</span> signal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                                <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">true</span>
                            <span class="token punctuation">}</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span>stderr<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                                <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                                <span class="token literal-property property">error</span><span class="token operator">:</span> data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                            <span class="token punctuation">}</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ç»“æŸè¿æ¥</span>
    <span class="token function">endConn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>conn<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>connAgent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>connAgent<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * æœ¬åœ°æ“ä½œ
 * */</span>
<span class="token keyword">class</span> <span class="token class-name">File</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">fileName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>fileName <span class="token operator">=</span> fileName
    <span class="token punctuation">}</span>

    <span class="token comment">// åˆ é™¤æœ¬åœ°æ–‡ä»¶</span>
    <span class="token function">deleteLocalFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            fs<span class="token punctuation">.</span><span class="token function">unlink</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileName<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                        error
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">true</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å‹ç¼©æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span>
    <span class="token comment">// eslint-disable-next-line space-before-function-paren</span>
    <span class="token function">zipFile</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// åˆ›å»ºæ–‡ä»¶è¾“å‡ºæµ</span>
            <span class="token comment">// eslint-disable-next-line no-path-concat</span>
            <span class="token keyword">const</span> output <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fileName<span class="token punctuation">)</span>
            <span class="token keyword">const</span> archive <span class="token operator">=</span> <span class="token function">archiver</span><span class="token punctuation">(</span><span class="token string">'zip'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">zlib</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">level</span><span class="token operator">:</span> <span class="token number">9</span> <span class="token punctuation">}</span> <span class="token comment">// è®¾ç½®å‹ç¼©çº§åˆ«</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>

            <span class="token comment">// æ–‡ä»¶è¾“å‡ºæµç»“æŸ</span>
            output<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">----å‹ç¼©æ–‡ä»¶æ€»å…± </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>archive<span class="token punctuation">.</span><span class="token function">pointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> å­—èŠ‚----</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----å‹ç¼©æ–‡ä»¶å¤¹å®Œæ¯•----'</span><span class="token punctuation">)</span>
                <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>

            <span class="token comment">// æ•°æ®æºæ˜¯å¦è€—å°½</span>
            output<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'----å‹ç¼©å¤±è´¥ï¼Œæ•°æ®æºå·²è€—å°½----'</span><span class="token punctuation">)</span>
                <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>

            <span class="token comment">// å­˜æ¡£è­¦å‘Š</span>
            archive<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'warning'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">'ENOENT'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'----statæ•…éšœå’Œå…¶ä»–éé˜»å¡é”™è¯¯----'</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'----å‹ç¼©å¤±è´¥----'</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
                <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>

            <span class="token comment">// å­˜æ¡£å‡ºé”™</span>
            archive<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'----å­˜æ¡£é”™è¯¯ï¼Œå‹ç¼©å¤±è´¥----'</span><span class="token punctuation">)</span>
                console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
                <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>

            <span class="token comment">// é€šè¿‡ç®¡é“æ–¹æ³•å°†è¾“å‡ºæµå­˜æ¡£åˆ°æ–‡ä»¶</span>
            archive<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span>

            <span class="token comment">// æ‰“åŒ…disté‡Œé¢çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•</span>
            archive<span class="token punctuation">.</span><span class="token function">directory</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>

            <span class="token comment">// archive.directory(`../${Config.buildDist}/`, false);</span>

            <span class="token comment">// å®Œæˆå½’æ¡£</span>
            archive<span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æ‰“åŒ…æœ¬åœ°å‰ç«¯æ–‡ä»¶</span>
    <span class="token function">buildProject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----å¼€å§‹ç¼–è¯‘æ‰“åŒ…æ–‡ä»¶ï¼Œè¯·è€å¿ƒç­‰å¾…----'</span><span class="token punctuation">,</span> buildCommand<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">exec</span><span class="token punctuation">(</span>Config<span class="token punctuation">.</span>buildCommand<span class="token punctuation">,</span> <span class="token keyword">async</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>

                    <span class="token comment">// eslint-disable-next-line prefer-promise-reject-errors</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">{</span> error<span class="token punctuation">,</span> <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>stdout<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        stdout<span class="token punctuation">,</span>
                        <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">true</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>stderr<span class="token punctuation">)</span>

                    <span class="token comment">// eslint-disable-next-line prefer-promise-reject-errors</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        <span class="token literal-property property">error</span><span class="token operator">:</span> stderr<span class="token punctuation">,</span>
                        <span class="token literal-property property">success</span><span class="token operator">:</span> <span class="token boolean">false</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// åœæ­¢ç¨‹åºä¹‹å‰éœ€åˆ é™¤æœ¬åœ°å‹ç¼©åŒ…æ–‡ä»¶</span>
    <span class="token function">stopProgress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">deleteLocalFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'----åˆ é™¤æœ¬åœ°æ–‡ä»¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨åˆ é™¤----'</span><span class="token punctuation">)</span>
                console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----å·²åˆ é™¤æœ¬åœ°å‹ç¼©åŒ…æ–‡ä»¶----'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// SSHè¿æ¥ï¼Œä¸Šä¼ ï¼Œè§£å‹ï¼Œåˆ é™¤ç­‰ç›¸å…³æ“ä½œ</span>
<span class="token comment">// eslint-disable-next-line space-before-function-paren</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">sshUpload</span><span class="token punctuation">(</span><span class="token parameter">sshConfig<span class="token punctuation">,</span> fileName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> sshCon <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SSH</span><span class="token punctuation">(</span>sshConfig<span class="token punctuation">)</span>
    <span class="token keyword">const</span> sshRes <span class="token operator">=</span> <span class="token keyword">await</span> sshCon<span class="token punctuation">.</span><span class="token function">connectServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>sshRes <span class="token operator">||</span> <span class="token operator">!</span>sshRes<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'----è¿æ¥æœåŠ¡å™¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®ä»¥åŠæœåŠ¡å™¨æ˜¯å¦å·²å¼€å¯è¿œç¨‹è¿æ¥----'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----è¿æ¥æœåŠ¡å™¨æˆåŠŸï¼Œå¼€å§‹ä¸Šä¼ æ–‡ä»¶----'</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> uploadRes <span class="token operator">=</span> <span class="token keyword">await</span> sshCon
        <span class="token punctuation">.</span><span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">localPath</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">remotePath</span><span class="token operator">:</span> sshConfig<span class="token punctuation">.</span>catalog <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> fileName
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>uploadRes <span class="token operator">||</span> <span class="token operator">!</span>uploadRes<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'----ä¸Šä¼ æ–‡ä»¶å¤±è´¥ï¼Œè¯·é‡æ–°ä¸Šä¼ ----'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----ä¸Šä¼ æ–‡ä»¶æˆåŠŸï¼Œå¼€å§‹è§£å‹æ–‡ä»¶----'</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> zipRes <span class="token operator">=</span> <span class="token keyword">await</span> sshCon<span class="token punctuation">.</span><span class="token function">execSsh</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">unzip -o </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sshConfig<span class="token punctuation">.</span>catalog <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> fileName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> -d </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sshConfig<span class="token punctuation">.</span>catalog<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>zipRes <span class="token operator">||</span> <span class="token operator">!</span>zipRes<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'----è§£å‹æ–‡ä»¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨è§£å‹zipæ–‡ä»¶----'</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">----é”™è¯¯åŸå› ï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>zipRes<span class="token punctuation">.</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">----</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Config<span class="token punctuation">.</span>deleteFile<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----è§£å‹æ–‡ä»¶æˆåŠŸï¼Œå¼€å§‹åˆ é™¤ä¸Šä¼ çš„å‹ç¼©åŒ…----'</span><span class="token punctuation">)</span>

        <span class="token comment">// æ³¨æ„ï¼šrm -rfä¸ºå±é™©æ“ä½œï¼Œè¯·å‹¿å¯¹æ­¤æ®µä»£ç åšå…¶ä»–éå¿…é¡»æ›´æ”¹</span>
        <span class="token keyword">const</span> deleteZipRes <span class="token operator">=</span> <span class="token keyword">await</span> sshCon<span class="token punctuation">.</span><span class="token function">execSsh</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">rm -rf </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sshConfig<span class="token punctuation">.</span>catalog <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> fileName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>deleteZipRes <span class="token operator">||</span> <span class="token operator">!</span>deleteZipRes<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'----åˆ é™¤æ–‡ä»¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨åˆ é™¤zipæ–‡ä»¶----'</span><span class="token punctuation">)</span>
            console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">----é”™è¯¯åŸå› ï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>deleteZipRes<span class="token punctuation">.</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">----</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ç»“æŸsshè¿æ¥</span>
    sshCon<span class="token punctuation">.</span><span class="token function">endConn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// æ‰§è¡Œå‰ç«¯éƒ¨ç½²</span>
<span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// å‹ç¼©åŒ…çš„åå­—</span>
    <span class="token keyword">const</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> year <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> month <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">const</span> day <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> timeStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>year<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>month<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>day<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token keyword">const</span> fileName <span class="token operator">=</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Config<span class="token punctuation">.</span>buildDist<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
        timeStr <span class="token operator">+</span>
        <span class="token string">'-'</span> <span class="token operator">+</span>
        Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.zip'</span>

    <span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span>

    <span class="token comment">// æ‰“åŒ…æ–‡ä»¶</span>
    <span class="token keyword">const</span> buildRes <span class="token operator">=</span> <span class="token keyword">await</span> file<span class="token punctuation">.</span><span class="token function">buildProject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>buildRes <span class="token operator">||</span> <span class="token operator">!</span>buildRes<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'----ç¼–è¯‘æ‰“åŒ…æ–‡ä»¶å‡ºé”™----'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buildRes<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----ç¼–è¯‘æ‰“åŒ…æ–‡ä»¶å®Œæˆ----'</span><span class="token punctuation">)</span>

    <span class="token comment">// å‹ç¼©æ–‡ä»¶</span>

    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> file<span class="token punctuation">.</span><span class="token function">zipFile</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Config<span class="token punctuation">.</span>buildDist<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>res <span class="token operator">||</span> <span class="token operator">!</span>res<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----å¼€å§‹è¿›è¡ŒSSHè¿æ¥----'</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Config<span class="token punctuation">.</span>publishEnv <span class="token keyword">instanceof</span> <span class="token class-name">Array</span> <span class="token operator">&amp;&amp;</span> Config<span class="token punctuation">.</span>publishEnv<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Config<span class="token punctuation">.</span>publishEnv<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">await</span> <span class="token function">sshUpload</span><span class="token punctuation">(</span>Config<span class="token punctuation">.</span>publishEnv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> fileName<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">await</span> <span class="token function">sshUpload</span><span class="token punctuation">(</span>Config<span class="token punctuation">.</span>publishEnv<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----éƒ¨ç½²æˆåŠŸï¼Œæ­£åœ¨ä¸ºæ‚¨åˆ é™¤æœ¬åœ°å‹ç¼©åŒ…----'</span><span class="token punctuation">)</span>
    file<span class="token punctuation">.</span><span class="token function">stopProgress</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br><span class="line-number">382</span><br><span class="line-number">383</span><br><span class="line-number">384</span><br><span class="line-number">385</span><br><span class="line-number">386</span><br><span class="line-number">387</span><br><span class="line-number">388</span><br><span class="line-number">389</span><br><span class="line-number">390</span><br><span class="line-number">391</span><br><span class="line-number">392</span><br><span class="line-number">393</span><br><span class="line-number">394</span><br><span class="line-number">395</span><br><span class="line-number">396</span><br><span class="line-number">397</span><br><span class="line-number">398</span><br><span class="line-number">399</span><br><span class="line-number">400</span><br><span class="line-number">401</span><br><span class="line-number">402</span><br><span class="line-number">403</span><br><span class="line-number">404</span><br><span class="line-number">405</span><br><span class="line-number">406</span><br><span class="line-number">407</span><br><span class="line-number">408</span><br><span class="line-number">409</span><br><span class="line-number">410</span><br><span class="line-number">411</span><br><span class="line-number">412</span><br><span class="line-number">413</span><br><span class="line-number">414</span><br><span class="line-number">415</span><br><span class="line-number">416</span><br><span class="line-number">417</span><br><span class="line-number">418</span><br><span class="line-number">419</span><br><span class="line-number">420</span><br><span class="line-number">421</span><br><span class="line-number">422</span><br><span class="line-number">423</span><br><span class="line-number">424</span><br><span class="line-number">425</span><br><span class="line-number">426</span><br></div></div></details> <h2 id="cbl-deploy-tools-å®ç°ä»£ç è‡ªåŠ¨æ‰“åŒ…ä¸Šä¼ "><a href="#cbl-deploy-tools-å®ç°ä»£ç è‡ªåŠ¨æ‰“åŒ…ä¸Šä¼ " class="header-anchor">#</a> cbl-deploy-tools å®ç°ä»£ç è‡ªåŠ¨æ‰“åŒ…ä¸Šä¼ </h2> <p>ä½¿ç”¨<code>cbl-deploy-tools</code>æ’ä»¶è¿›è¡Œç›´æ¥å‘ç‰ˆï¼Œåœ¨<code>package.json</code>ä¸­é…ç½®<code>&quot;push&quot;: &quot;cbl-dt&quot;,</code>å°±å¯ä»¥ç›´æ¥è¿è¡Œå‘½ä»¤<code>yarn push</code>æˆ–è€…<code>npm run push</code>è¿›è¡Œå‘ç‰ˆæ“ä½œï¼Œæ³¨æ„åœ¨å‘ç‰ˆçš„è¿‡ç¨‹ä¸­ä¼šè®©ä½ é€‰æ‹©å‘ç‰ˆçš„ç¯å¢ƒï¼Œå’Œæ˜¯å¦éœ€è¦å¤‡ä»½ã€‚
</p><details><summary><b>cbl-dt-config.jsonæ–‡ä»¶ä»£ç åŠä¸Šä¼ æ­¥éª¤</b></summary><p></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;host&quot;</span><span class="token operator">:</span> <span class="token string">&quot;192.155.1.120&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token string">&quot;22&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run build:test&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;localDist&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./dist&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;targetDist&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/home/docker/nginx/plp-saas&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;auto&quot;</span><span class="token operator">:</span> <span class="token string">&quot;01&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prod&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;host&quot;</span><span class="token operator">:</span> <span class="token string">&quot;192.155.1.120&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token string">&quot;22&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run build:prod&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;localDist&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./dist&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;targetDist&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/home/docker/nginx/plp-saas&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;auto&quot;</span><span class="token operator">:</span> <span class="token string">&quot;01&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>é€‰æ‹©ä¸Šä¼ ç¯å¢ƒ
<img src="/blog/assets/img/upload_one.d186ef0f.jpg" style="height:100%;width:100%;">
æ˜¯å¦å¤‡ä»½
<img src="/blog/assets/img/upload_two.756afe8c.jpg" style="height:100%;width:100%;">
ä¸Šä¼ æˆåŠŸ
<img src="/blog/assets/img/upload_three.aa29b586.jpg" style="height:100%;width:100%;"></p></details></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/blog/article/Other/OnlinePayment.html" class="prev">
        åœ¨çº¿æ”¯ä»˜
      </a></span> <span class="next"><a href="/blog/article/Other/Vscode.html">
        vscodeå¸¸ç”¨æ’ä»¶
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.95d1cef2.js" defer></script><script src="/blog/assets/js/2.dd56d6fa.js" defer></script><script src="/blog/assets/js/1.05d0606b.js" defer></script><script src="/blog/assets/js/18.6933475c.js" defer></script>
  </body>
</html>
